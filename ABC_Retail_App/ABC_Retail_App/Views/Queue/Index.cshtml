@using System.Collections.Generic
@{
    ViewData["Title"] = "Azure Queues";
    var orderQueueMessages = ViewBag.OrderQueueMessages as List<string> ?? new List<string>();
    var inventoryQueueMessages = ViewBag.InventoryQueueMessages as List<string> ?? new List<string>();
}

<div class="container mx-auto p-4">
    <h1 class="text-3xl font-bold mb-6 text-gray-800">Azure Queue Storage (Order & Inventory)</h1>

    @if (TempData["SuccessMessage"] != null)
    {
        <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4" role="alert">
            <strong class="font-bold">Success!</strong>
            <span class="block sm:inline">@TempData["SuccessMessage"]</span>
        </div>
    }
    @if (TempData["ErrorMessage"] != null)
    {
        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
            <strong class="font-bold">Error!</strong>
            <span class="block sm:inline">@TempData["ErrorMessage"]</span>
        </div>
    }
    @if (TempData["InfoMessage"] != null)
    {
        <div class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded relative mb-4" role="alert">
            <strong class="font-bold">Info!</strong>
            <span class="block sm:inline">@TempData["InfoMessage"]</span>
        </div>
    }

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
        <!-- Send Message Section -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-2xl font-semibold mb-4 text-gray-700">Send New Message</h2>
            <form asp-action="SendMessage" method="post">
                <div class="mb-4">
                    <label for="queueName" class="block text-gray-700 text-sm font-bold mb-2">Select Queue:</label>
                    <select name="queueName" id="queueName" class="shadow appearance-none border rounded-md w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                        <option value="order-processing">Order Processing</option>
                        <option value="inventory-management">Inventory Management</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label for="messageContent" class="block text-gray-700 text-sm font-bold mb-2">Message Content:</label>
                    <textarea name="messageContent" id="messageContent" rows="3" class="shadow appearance-none border rounded-md w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" placeholder="e.g., Processing order #123 for Customer A" required></textarea>
                </div>
                <button type="submit" class="inline-flex items-center px-4 py-2 bg-indigo-600 text-white font-semibold rounded-md shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                    <svg class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                    </svg>
                    Send Message
                </button>
            </form>
        </div>

        <!-- Order Processing Queue -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-2xl font-semibold mb-4 text-gray-700">Order Processing Queue</h2>
            <div class="max-h-60 overflow-y-auto mb-4 bg-gray-50 p-3 rounded-md border border-gray-200">
                @if (orderQueueMessages.Any())
                {
                    <ul class="list-disc list-inside text-gray-700">
                        @foreach (var message in orderQueueMessages)
                        {
                            <li>@message</li>
                        }
                    </ul>
                }
                else
                {
                    <p class="text-gray-500">No messages in queue.</p>
                }
            </div>
            <form asp-action="DequeueMessage" method="post" class="inline-block">
                <input type="hidden" name="queueName" value="order-processing" />
                <button type="submit" class="inline-flex items-center px-4 py-2 bg-teal-600 text-white font-semibold rounded-md shadow-sm hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500">
                    <svg class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                    </svg>
                    Dequeue Message
                </button>
            </form>
        </div>

        <!-- Inventory Management Queue -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-2xl font-semibold mb-4 text-gray-700">Inventory Management Queue</h2>
            <div class="max-h-60 overflow-y-auto mb-4 bg-gray-50 p-3 rounded-md border border-gray-200">
                @if (inventoryQueueMessages.Any())
                {
                    <ul class="list-disc list-inside text-gray-700">
                        @foreach (var message in inventoryQueueMessages)
                        {
                            <li>@message</li>
                        }
                    </ul>
                }
                else
                {
                    <p class="text-gray-500">No messages in queue.</p>
                }
            </div>
            <form asp-action="DequeueMessage" method="post" class="inline-block">
                <input type="hidden" name="queueName" value="inventory-management" />
                <button type="submit" class="inline-flex items-center px-4 py-2 bg-teal-600 text-white font-semibold rounded-md shadow-sm hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500">
                    <svg class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                    </svg>
                    Dequeue Message
                </button>
            </form>
        </div>
    </div>
</div>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
    body {
        font-family: 'Inter', sans-serif;
    }
</style>
